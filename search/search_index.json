{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Riverbed RCPE Professional Riverbed RCPE Professional: Implement WAN Optimization Course Notes and Discussion. \ud83e\uddd0 About Riverbed RCPE Professional: Implement WAN Optimization Course Notes and Discussion. This content is intended for personal reference and collaboration only! Course Name: RCPE Professional: Implement WAN Optimization Dates: 23rd - 27th of May 2022 Start time: 0900 NZST 0700 AEST Trainer: Pat Robson \ud83d\udcda Reference Material Riverbed Lab Dashboard Course Specific Labs Zoom Meeting Technet Article \u26cf\ufe0f Built Using Mkdocs Mkdocs Material Markdown Git Python \ud83d\ude80 Deployment Before starting you need to have Git and Python installed. # Clone this project git clone https://github.com/jodisfields/Riverbed-RCPE.git # Access cd Riverbed-RCPE # Install dependencies pip install -r requirements.txt # Run the project mkdocs serve # Open in browser Navigate to http://localhost:8000 \ud83d\udcdd Acknowledgements Riverbed","title":"Home"},{"location":"#about","text":"Riverbed RCPE Professional: Implement WAN Optimization Course Notes and Discussion. This content is intended for personal reference and collaboration only! Course Name: RCPE Professional: Implement WAN Optimization Dates: 23rd - 27th of May 2022 Start time: 0900 NZST 0700 AEST Trainer: Pat Robson","title":"\ud83e\uddd0 About"},{"location":"#reference-material","text":"Riverbed Lab Dashboard Course Specific Labs Zoom Meeting Technet Article","title":"\ud83d\udcda Reference Material"},{"location":"#built-using","text":"Mkdocs Mkdocs Material Markdown Git Python","title":"\u26cf\ufe0f Built Using"},{"location":"#deployment","text":"Before starting you need to have Git and Python installed. # Clone this project git clone https://github.com/jodisfields/Riverbed-RCPE.git # Access cd Riverbed-RCPE # Install dependencies pip install -r requirements.txt # Run the project mkdocs serve # Open in browser Navigate to http://localhost:8000","title":"\ud83d\ude80 Deployment"},{"location":"#acknowledgements","text":"Riverbed","title":"\ud83d\udcdd Acknowledgements"},{"location":"first-lab/","text":"Knowledge check Part 1 Hint: hovering icons in your Current Connections screen can answer both Parts... In the view below, what informs the connection is optimized? In the view below, what informs the connection is encrypted over the WAN? Calculate the approximate speed for the SMB file transfers, cold and warm. How do they compare to the previous non optimized transfer? Take some time to experiment Part 2 What was the peak LAN throughput in your timescale for HTTPS traffic? What was it for HTTP and SMB? Why would the optimization effects differ on a \"cold pass\" of one type of data/traffic versus another? Part 3 Note the scale on the Y axis of the chart is automatically adjusted to suit. Hover the mouse over the plot area to display the Data Reduction for various points on the timeline. Note that the LAN Throughput should be greater than WAN Throughput to imply optimization occurring and reducing the amount of throughput on the WAN. What was the peak LAN throughput? When did it happen? What protocol was it? What was the total amount of data that was removed from the WAN during your time period? You have successfully created optimized traffic in an in-path deployment, and should understand the nature of cold and warm file transfers. Ideally you noticed significant improvement in transfer times, even with file modifications. Useful add-on: SDR is protocol agnostic, so the warm transfer of a byte stream in one application will be equally optimized should that byte stream occur in a different applications. As an example, downloading a file from the datacenter via a file share, then sending the file via email; your local and datacenter SteelHeads will see the file 'cold' when downloading, then 'warm' when that same file is attached to an email. Finally, you verified various optimization statistics in different Reports. Good to note that bandwidth reduction/optimization is enabled by default for all TCP ports not explicitly passed through. Once your SteelHead appliance is plugged in and configured with the initial network settings, you can begin optimizing traffic and notice significant performance increase, with accompanying WAN data reduction.","title":"Knowledge check"},{"location":"first-lab/#knowledge-check","text":"","title":"Knowledge check"},{"location":"first-lab/#part-1","text":"Hint: hovering icons in your Current Connections screen can answer both Parts... In the view below, what informs the connection is optimized? In the view below, what informs the connection is encrypted over the WAN? Calculate the approximate speed for the SMB file transfers, cold and warm. How do they compare to the previous non optimized transfer? Take some time to experiment","title":"Part 1"},{"location":"first-lab/#part-2","text":"What was the peak LAN throughput in your timescale for HTTPS traffic? What was it for HTTP and SMB? Why would the optimization effects differ on a \"cold pass\" of one type of data/traffic versus another?","title":"Part 2"},{"location":"first-lab/#part-3","text":"Note the scale on the Y axis of the chart is automatically adjusted to suit. Hover the mouse over the plot area to display the Data Reduction for various points on the timeline. Note that the LAN Throughput should be greater than WAN Throughput to imply optimization occurring and reducing the amount of throughput on the WAN. What was the peak LAN throughput? When did it happen? What protocol was it? What was the total amount of data that was removed from the WAN during your time period? You have successfully created optimized traffic in an in-path deployment, and should understand the nature of cold and warm file transfers. Ideally you noticed significant improvement in transfer times, even with file modifications. Useful add-on: SDR is protocol agnostic, so the warm transfer of a byte stream in one application will be equally optimized should that byte stream occur in a different applications. As an example, downloading a file from the datacenter via a file share, then sending the file via email; your local and datacenter SteelHeads will see the file 'cold' when downloading, then 'warm' when that same file is attached to an email. Finally, you verified various optimization statistics in different Reports. Good to note that bandwidth reduction/optimization is enabled by default for all TCP ports not explicitly passed through. Once your SteelHead appliance is plugged in and configured with the initial network settings, you can begin optimizing traffic and notice significant performance increase, with accompanying WAN data reduction.","title":"Part 3"},{"location":"license-tiers/","text":"License Tiers","title":"License Tiers"},{"location":"license-tiers/#license-tiers","text":"","title":"License Tiers"},{"location":"quick-notes/","text":"Quick Notes SteelHead-V Best Practices Dont's \u274c Do not share NICS and use at least 1Gbps Do not use hyperthreading Do not share physical disks between hosts Do not over provision CPU Use a Server Grade CPU for the Hypervisor Do's: \u2705 Allow resources Hypervisor overhead Always reserve Virtual RAM / Physical RAM Use SSDs or other high speed disk for the Segstore Apply BIOS power settings for maximum performance Steel Head-v and Riverbed Bypass NIC Riverbed Bypass NIC-A physical card for the virtual device. ESX/ESXI Direct Path feature Allows SteelHead-v to contral the bypass hardware: ESXI driver available from the support website Under related Software Hyper-V & KVM support Deployment Methods: Physical In-Path LAN & WAN Connected We will look into more detail on: Serial clusters Parallel clusters Simplified Routing Failover Scenarios Deployment Methods: Virtual In-Path WAN physically connected - in-paths interfaces used for optimization We will look into more detail on: Policy-based Routing WCCP Interceptor Layer-4 Switch Deployment Methods - Cloud Optimization Cloud Computing Private cloud: Resources match demand, but can be slow or expensive to adapt Management of resources without restrictions Security Compliance High Availability, but at a cost Public cloud: Scalable and agile Consumer-based billing High Availability Hybrid cloud: As the name implies. Deployment Methods & Network Asymmetry Network Asymmetry Affects Optimization Asymmetric Routing (AR) can be disruptive in optimized environments! SteelHeads need two-way traffic to optimize, regardless of topology: In-path virtual in-path Virtual in-path can also be a solution, more later As a result the initial connection will take longer, or even fail SteelHeads will pass through all IP pairs for 24 hours when AR detected. This is to avoid reoccurring fallures The table can be flushed manually, but must be done on all affected SteelHeads Consider manual reset or an auto-kickoff rule Remember nothing happens until we see a SYN message . Enhanced Auto Discovery (EAD) Why Use EAD? Default since RIOS version 5.5.4 Used to find the LAST Steel Head, not the first Useful on double WAN hops Also useful in serial deployments, but peering rules are much better Faster to fail when the server is not available Faster to detect network asymmetry Why Not Use EAD? May need to be disabled in certain SaaS backhaul deployments, or when overcoming egregious WAN latency such as double satellite Wireshark PCAP of EAD traffic Options: (28 bytes), Maximum segment size, No-Operation (NOP) Maximum segment size: 1460 bytes No-Operation (NOP) Window scale: 8 (multiply by 256) No-Operation (NOP), No-Operation (NOP) TCP SACK Permitted Option: Truel Riverbed Probe: Probe Query, CSH IP: 10.1.120.21 Length: 10 Kind: Riverbed Probe (76) Length: 10 0000... Type: 0 .... 0001 Version: 1 Reserved: 0x01 CSH IP: 10.1.120.21 Application Version: 5 Riverbed Probe: Probe Query Info Length: 4 Kind: Riverbed Probe (76) Length: 4 0000 110. Type: 6 .......8 Version: 2 Probe Flags: 0x21 No-Operation (NOP) End of Option List (EOL) Transparency Options Field Carried in EVERY packet, after SYN and SYN/ACK Configured on in-path rules: Can be with Fixed Target (on cli and in-path only) Filter on Wireshark: tcp.options.rvbd.trpy 4e labels packets as \"WAN side Optimized\" for use by: SteelHeads Interceptors SteelCentral devices Contains pseudo Src/Dest IP and ports Effectively NAT/PAT on egress of steelhead Why use different modes? Honestly, in most circumstances, correct addressing is fine however it does depend on the Steel Head deployment method. In SD-WAN environments, full transparency is required so that the SD-WAN policy in place to use a different bearer based on the application or any 5 tuples. Disadvantages of transparency: You lose a feature called Connection pooling, where 20 TCP connections are pre-established between every peer. This skips the need for a 3-way handshake when a session over the WAN is initiated.**** Management and Configuration (Mgmt & Config) Management is available on all interfaces by default Rest API for special purposes such as automation Graphical User Interface via HTTP / HTTPS MIB downloadable from the GUI Telnet (disabled by default) Rest API SNMP SSH BMC Best Practice: Always use the SCC. CLI Command Entry Modes User Enable Config Riverbed SteelHead Show Interface VCX255-A #sh int inpath0_0 Interface: inpath0 0 State: Up Interface type: ethernet IP address: 10.1.30.125 Netmask: 255.255.255.0 IPv6 link-local address: fe80::20c:29ff: fe28:b93d/64 MTU: 1500 HW address: 00:0C:29:28:B9:3D Traffic status: Normal HW blockable: no Counters cleared date: 2019/12/12 11:43:00 RX bytes: 6526710 RX mcast packets: 51827 errors: 0 RX overruns: 100 TX bytes: 1548 Riverbed SteelHead configuration wizard VCX255-A (config) conf jump-start Step 1: Hostname? (VCX255-A1) Step 2: Use DHCP on primary interface? [no] Step 3: Primary IP address? [10.1.30.25) Step 4: Netmask? [255.255.255.0] Step 5: Default gateway? [10.1.30.254] Step 6: Primary DNS server? (10.1.30.102) Step 7: Domain name? [training.local] Step 8: Admin password? Step 9: SMTP server? Step 10: Notification email address? Step 11: Set the primary interface speed? [auto] Step 12: Set the primary interface duplex? [auto] Step 13: Would you like to activate the in-path configuration? [yes] Step 14: In-Path IP address? (10.1.30.125) Step 15: In-Path Netmask? 1255.255.255.01 Step 16: In-Path Default gateway? [10.1.30.254) Step 17: Set the in-path:LAN interface aspeed? [auto] Step 18: Set the In-path: LAN interface duplex? [auto] Step 19: Set the in-path:WAN interface speed? [auto] Step 20: Set the in-path: WAN Interface duplex? [auto] Network interface configuration interface aux description interface aux dhcp interface aux dhcp dynamic-dns no interface aux dhcpv6 no interface aux shutdown interface aux dhcpv6 dynamic-dns interface aux mtu \"1588\" interface aux speed \"auto\" interface inpath8 8 description \"\" no interface inpath8_8 dhcp no interface inpath8 8 dhcp dynamic-dns na interface inpath8_8 dhcpv6 no interface inpath8 8 dhcpv6 dynamic-dns no interface interface inpath0 8 force-Mdi-x enable inpath8_8 ip address 18.1.58.125 /24 interface inpath8 8 mtu \"1588\" interface interface inpath8_8 napi-weight \"128\" inpath8_8 shutdown interface inpath8_8 speed \"auto\" no interface shutdown inpathB 8 txqueuelen \"188\" lo description Housekeeping - Licensing Structure Licenses are small strings of text tied to the HW Example: LK1-SH40SSL-0000-0000-5-8B40-0361-F11D Basic Licenses plus options and sizing can be added by: CLI GUI Call Home function Housekeeping - Export Flow Statistics NetFlow and other Flow Data Collectors gather network statistics about network hosts, protocols and ports, peak usage times, traffic paths, and others The flow data collectors update flow records with information pertaining to each packet traversing a specified network interface Housekeeping - Flow Data Component Basics Exporter - A device that sees the data flows going through the network, such as a SteelHead or a router Collector - A server or appliance designed to aggregate data sent to it by NetFlow Exporter, such as Steel Central Flow Gateway Analyzer - A collection of tools (usually provided in conjunction with a collector) used to analyze the data and provide relevant data summaries and graphs, such as SteelCentral NetProfiler Housekeeping - Configuration Management The Configuration is held in binary format Pasting a text file to the CLI is NOT recommended Configuration files are backed up locally with a .bak copy and can be uploaded manually to a server - Files are also regularly backed up to the SCC Files can be saved locally before every change Creates an easy rollback if required in a service window Authentication The following user authentication methods are available for administrative and monitoring purposes: \ud83d\udd12 Local \ud83d\udd12 SAML \ud83d\udd12 RADIUS \ud83d\udd12 TACACS+ Custom Shell profiles and AV pairs are required for SteelHeads This is covered by many knowledgebase articles. Admin Account: Administrator privileges Monitor Account: Read only access Gist is available for Cisco ACS environments in article 516158 Typically local site admins don't need RW access as everything Should be managed via an SCC . If you make changes locally and don't reflect them on the SCC, they'll be wiped next time there is a push.","title":"Quick Notes"},{"location":"quick-notes/#quick-notes","text":"","title":"Quick Notes"},{"location":"quick-notes/#steelhead-v-best-practices","text":"Dont's \u274c Do not share NICS and use at least 1Gbps Do not use hyperthreading Do not share physical disks between hosts Do not over provision CPU Use a Server Grade CPU for the Hypervisor Do's: \u2705 Allow resources Hypervisor overhead Always reserve Virtual RAM / Physical RAM Use SSDs or other high speed disk for the Segstore Apply BIOS power settings for maximum performance","title":"SteelHead-V Best Practices"},{"location":"quick-notes/#steel-head-v-and-riverbed-bypass-nic","text":"Riverbed Bypass NIC-A physical card for the virtual device. ESX/ESXI Direct Path feature Allows SteelHead-v to contral the bypass hardware: ESXI driver available from the support website Under related Software Hyper-V & KVM support","title":"Steel Head-v and Riverbed Bypass NIC"},{"location":"quick-notes/#deployment-methods-physical-in-path","text":"LAN & WAN Connected We will look into more detail on: Serial clusters Parallel clusters Simplified Routing Failover Scenarios","title":"Deployment Methods: Physical In-Path"},{"location":"quick-notes/#deployment-methods-virtual-in-path","text":"WAN physically connected - in-paths interfaces used for optimization We will look into more detail on: Policy-based Routing WCCP Interceptor Layer-4 Switch","title":"Deployment Methods: Virtual In-Path"},{"location":"quick-notes/#deployment-methods-cloud-optimization-cloud-computing","text":"Private cloud: Resources match demand, but can be slow or expensive to adapt Management of resources without restrictions Security Compliance High Availability, but at a cost Public cloud: Scalable and agile Consumer-based billing High Availability Hybrid cloud: As the name implies.","title":"Deployment Methods - Cloud Optimization Cloud Computing"},{"location":"quick-notes/#deployment-methods-network-asymmetry","text":"Network Asymmetry Affects Optimization Asymmetric Routing (AR) can be disruptive in optimized environments! SteelHeads need two-way traffic to optimize, regardless of topology: In-path virtual in-path Virtual in-path can also be a solution, more later As a result the initial connection will take longer, or even fail SteelHeads will pass through all IP pairs for 24 hours when AR detected. This is to avoid reoccurring fallures The table can be flushed manually, but must be done on all affected SteelHeads Consider manual reset or an auto-kickoff rule Remember nothing happens until we see a SYN message .","title":"Deployment Methods &amp; Network Asymmetry"},{"location":"quick-notes/#enhanced-auto-discovery-ead","text":"Why Use EAD? Default since RIOS version 5.5.4 Used to find the LAST Steel Head, not the first Useful on double WAN hops Also useful in serial deployments, but peering rules are much better Faster to fail when the server is not available Faster to detect network asymmetry Why Not Use EAD? May need to be disabled in certain SaaS backhaul deployments, or when overcoming egregious WAN latency such as double satellite","title":"Enhanced Auto Discovery (EAD)"},{"location":"quick-notes/#wireshark-pcap-of-ead-traffic","text":"Options: (28 bytes), Maximum segment size, No-Operation (NOP) Maximum segment size: 1460 bytes No-Operation (NOP) Window scale: 8 (multiply by 256) No-Operation (NOP), No-Operation (NOP) TCP SACK Permitted Option: Truel Riverbed Probe: Probe Query, CSH IP: 10.1.120.21 Length: 10 Kind: Riverbed Probe (76) Length: 10 0000... Type: 0 .... 0001 Version: 1 Reserved: 0x01 CSH IP: 10.1.120.21 Application Version: 5 Riverbed Probe: Probe Query Info Length: 4 Kind: Riverbed Probe (76) Length: 4 0000 110. Type: 6 .......8 Version: 2 Probe Flags: 0x21 No-Operation (NOP) End of Option List (EOL)","title":"Wireshark PCAP of EAD traffic"},{"location":"quick-notes/#transparency-options-field","text":"Carried in EVERY packet, after SYN and SYN/ACK Configured on in-path rules: Can be with Fixed Target (on cli and in-path only) Filter on Wireshark: tcp.options.rvbd.trpy 4e labels packets as \"WAN side Optimized\" for use by: SteelHeads Interceptors SteelCentral devices Contains pseudo Src/Dest IP and ports Effectively NAT/PAT on egress of steelhead","title":"Transparency Options Field"},{"location":"quick-notes/#why-use-different-modes","text":"Honestly, in most circumstances, correct addressing is fine however it does depend on the Steel Head deployment method. In SD-WAN environments, full transparency is required so that the SD-WAN policy in place to use a different bearer based on the application or any 5 tuples. Disadvantages of transparency: You lose a feature called Connection pooling, where 20 TCP connections are pre-established between every peer. This skips the need for a 3-way handshake when a session over the WAN is initiated.****","title":"Why use different modes?"},{"location":"quick-notes/#management-and-configuration-mgmt-config","text":"Management is available on all interfaces by default Rest API for special purposes such as automation Graphical User Interface via HTTP / HTTPS MIB downloadable from the GUI Telnet (disabled by default) Rest API SNMP SSH BMC Best Practice: Always use the SCC. CLI Command Entry Modes User Enable Config","title":"Management and Configuration (Mgmt &amp; Config)"},{"location":"quick-notes/#riverbed-steelhead-show-interface","text":"VCX255-A #sh int inpath0_0 Interface: inpath0 0 State: Up Interface type: ethernet IP address: 10.1.30.125 Netmask: 255.255.255.0 IPv6 link-local address: fe80::20c:29ff: fe28:b93d/64 MTU: 1500 HW address: 00:0C:29:28:B9:3D Traffic status: Normal HW blockable: no Counters cleared date: 2019/12/12 11:43:00 RX bytes: 6526710 RX mcast packets: 51827 errors: 0 RX overruns: 100 TX bytes: 1548","title":"Riverbed SteelHead Show Interface"},{"location":"quick-notes/#riverbed-steelhead-configuration-wizard","text":"VCX255-A (config) conf jump-start Step 1: Hostname? (VCX255-A1) Step 2: Use DHCP on primary interface? [no] Step 3: Primary IP address? [10.1.30.25) Step 4: Netmask? [255.255.255.0] Step 5: Default gateway? [10.1.30.254] Step 6: Primary DNS server? (10.1.30.102) Step 7: Domain name? [training.local] Step 8: Admin password? Step 9: SMTP server? Step 10: Notification email address? Step 11: Set the primary interface speed? [auto] Step 12: Set the primary interface duplex? [auto] Step 13: Would you like to activate the in-path configuration? [yes] Step 14: In-Path IP address? (10.1.30.125) Step 15: In-Path Netmask? 1255.255.255.01 Step 16: In-Path Default gateway? [10.1.30.254) Step 17: Set the in-path:LAN interface aspeed? [auto] Step 18: Set the In-path: LAN interface duplex? [auto] Step 19: Set the in-path:WAN interface speed? [auto] Step 20: Set the in-path: WAN Interface duplex? [auto]","title":"Riverbed SteelHead configuration wizard"},{"location":"quick-notes/#network-interface-configuration","text":"interface aux description interface aux dhcp interface aux dhcp dynamic-dns no interface aux dhcpv6 no interface aux shutdown interface aux dhcpv6 dynamic-dns interface aux mtu \"1588\" interface aux speed \"auto\" interface inpath8 8 description \"\" no interface inpath8_8 dhcp no interface inpath8 8 dhcp dynamic-dns na interface inpath8_8 dhcpv6 no interface inpath8 8 dhcpv6 dynamic-dns no interface interface inpath0 8 force-Mdi-x enable inpath8_8 ip address 18.1.58.125 /24 interface inpath8 8 mtu \"1588\" interface interface inpath8_8 napi-weight \"128\" inpath8_8 shutdown interface inpath8_8 speed \"auto\" no interface shutdown inpathB 8 txqueuelen \"188\" lo description","title":"Network interface configuration"},{"location":"quick-notes/#housekeeping-licensing-structure","text":"Licenses are small strings of text tied to the HW Example: LK1-SH40SSL-0000-0000-5-8B40-0361-F11D Basic Licenses plus options and sizing can be added by: CLI GUI Call Home function","title":"Housekeeping - Licensing Structure"},{"location":"quick-notes/#housekeeping-export-flow-statistics","text":"NetFlow and other Flow Data Collectors gather network statistics about network hosts, protocols and ports, peak usage times, traffic paths, and others The flow data collectors update flow records with information pertaining to each packet traversing a specified network interface","title":"Housekeeping - Export Flow Statistics"},{"location":"quick-notes/#housekeeping-flow-data-component-basics","text":"Exporter - A device that sees the data flows going through the network, such as a SteelHead or a router Collector - A server or appliance designed to aggregate data sent to it by NetFlow Exporter, such as Steel Central Flow Gateway Analyzer - A collection of tools (usually provided in conjunction with a collector) used to analyze the data and provide relevant data summaries and graphs, such as SteelCentral NetProfiler","title":"Housekeeping - Flow Data Component Basics"},{"location":"quick-notes/#housekeeping-configuration-management","text":"The Configuration is held in binary format Pasting a text file to the CLI is NOT recommended Configuration files are backed up locally with a .bak copy and can be uploaded manually to a server - Files are also regularly backed up to the SCC Files can be saved locally before every change Creates an easy rollback if required in a service window","title":"Housekeeping - Configuration Management"},{"location":"quick-notes/#authentication","text":"The following user authentication methods are available for administrative and monitoring purposes: \ud83d\udd12 Local \ud83d\udd12 SAML \ud83d\udd12 RADIUS \ud83d\udd12 TACACS+ Custom Shell profiles and AV pairs are required for SteelHeads This is covered by many knowledgebase articles. Admin Account: Administrator privileges Monitor Account: Read only access Gist is available for Cisco ACS environments in article 516158 Typically local site admins don't need RW access as everything Should be managed via an SCC . If you make changes locally and don't reflect them on the SCC, they'll be wiped next time there is a push.","title":"Authentication"}]}